
# 核心概念
| 模式 | 核心理念 | 特点 |
|------|----------|------|
| **本地 AI直接操作Obsidian vault** | Vault 就是文件，任何工具都能自由操作 | 简单直观、灵活快速、离线优先 |
| **Local REST API + MCP/n8n** | 把 Vault 封装为服务/API，LLM & 工具通过调用执行任务 | 受控、安全、可组合、可审计 |

---

# 对比分析

## 1. 自由度与灵活性
| 维度 | 文件优先 | API/MCP 优先 |
|------|-----------|--------------|
| 自由度 | 极高，自由读写，无需额外依赖 | 受控，受 API 定义约束 |
| 上手门槛 | 零门槛，直接编辑文件 | 需配置插件/服务 |
| 创新实验 | 快速原型化，立刻验证 | 较慢，需扩展 API 才能试新功能 |

---

## 2. 使用体验
| 维度 | 文件优先 | API/MCP 优先 |
|------|-----------|--------------|
| 交互体验 | 保存即见结果，直观 | 请求-响应模式，可返回结构化预览（diff、修改列表） |
| 写作场景 | 非常适合（润色、改写、续写） | 多余（比直接写复杂） |
| 审核机制 | 依赖 Git/人工比对 | API 可天然支持 dry-run 与 diff 预览 |

---

## 3. 安全与信任模型
| 维度 | 文件优先 | API/MCP 优先 |
|------|-----------|--------------|
| 数据控制 | 数据始终在本地，符合 Obsidian 本地化理念 | 同样可本地，但需保证 API 不对外暴露 |
| 权限 | 无限制，工具有完整访问权限 | 可配置权限、白名单 |
| 风险 | 无意覆盖/错误难以追踪 | 可审计、可限制高危操作 |

---

## 4. 语义一致性与内部机制
| 维度 | 文件优先 | API/MCP 优先 |
|------|-----------|--------------|
| 文件改动 | 直接修改文件内容 | 提供原子化接口（如 rename+fix backlinks） |
| 插件联动 | 改动可能不触发 Obsidian 插件事件 | 在 Obsidian 内执行，触发 metadataCache、模板等 |
| 一致性保障 | 需外部脚本保证 | 内部事件流保证一致性 |

---

## 5. 工程与运维
| 维度 | 文件优先 | API/MCP 优先 |
|------|-----------|--------------|
| 部署复杂度 | 无需部署，直接用 | 需安装 Local REST API 插件 + 配置 MCP/n8n |
| 团队协作 | 工具链碎片化，难复用 | API 工具化，可复用与共享 |
| 日志与回滚 | 依赖 Git 或快照 | API 层可内置日志、回滚机制 |
| 编排能力 | 需手工脚本 | 可通过 n8n 等可视化工作流编排 |

---

# 适用场景划分
| 操作类型 | 文件优先 | API/MCP 优先 |
|----------|-----------|--------------|
| 草稿写作、润色 | ✅ 最适合 | ❌ 不必要 |
| 一次性导入初稿 | ✅ 快速 | ❌ 多余 |
| 批量文本替换 | ✅ 可行 | ⚠️ 更稳妥 |
| 重命名文件并修正链接 | ❌ 高风险 | ✅ 推荐 |
| 批量更新 frontmatter | ❌ 易出错 | ✅ 安全 |
| 自动化归档/合并 | ❌ 容易破坏一致性 | ✅ 更适合 |
| 与插件联动（任务、模板） | ❌ 难触发事件 | ✅ 可直接触发 |

---

# 推荐混合策略
| 阶段 | 策略 | 工具 |
|------|-------|------|
| **Phase 0** | 纯文件优先（快速原型） | Cursor、VS Code、本地 AI |
| **Phase 1** | 将高风险操作 API 化 | Local REST API 插件 |
| **Phase 2** | 接入 MCP，暴露给 LLM | Claude Desktop、Cursor MCP |
| **Phase 3** | 使用 n8n 编排，增加日志/审计 | n8n、本地日志系统 |

---

# 总结
- **文件优先**：最大化发挥 Obsidian 的“本地化自由”理念，适合创作、实验、个人使用。  
- **API/MCP 优先**：强调安全性、一致性、可组合性，适合高风险操作与团队/自动化场景。  
- **最佳实践**：写作在文件层，运维和结构化变更在服务层，二者结合，既保留自由，也确保安全。

